const mongoose = require("mongoose");
const bcrtpt = require("bcryptjs");
const jwt = require("jsonwebtoken");
const follower = new mongoose.Schema({
  uID: String,
  email: String,
  username: String,
});
const following = new mongoose.Schema({
  uID: String,
  email: String,
  username: String,
});
const favourite = new mongoose.Schema({
  uID: String,
  email: String,
  username: String,
  postID: String,
});
const userSchema = new mongoose.Schema({
  username: {
    type: String,
    required: true,
    unique: true,
  },
  email: {
    type: String,
    required: true,
    unique: true,
  },
  phone: {
    type: String,
    required: true,
  },
  password: {
    type: String,
    required: true,
  },
  image :{
    type: String,
    default: "data:image/jpeg;base64,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"
  },
  followers: [follower],
  following: [following],
  favourite: [favourite],
  Date: {
    type: Date,
    default: Date.now,
  },
});
userSchema.pre("save", async function (next) {
  try {
    if (this.isModified("password")) {
      this.password = await bcrtpt.hash(this.password, 10);
    }
    next();
  } catch (error) {
    console.log(error);
  }
});
userSchema.methods.generateAuthToken = async function () {
  try {
    return jwt.sign(
      { _id: this._id, email: this.email },
      process.env.SECRET_KEY,
      {
        expiresIn: "1h",
      }
    );
  } catch (err) {
    const error = [400, err.message];
    next(error);
  }
};
const User = mongoose.model("User", userSchema);
module.exports = User;
